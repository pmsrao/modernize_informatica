<?xml version="1.0"?>
<MAPPING NAME="M_INGEST_CUSTOMERS">
  <!-- Mapping: Ingest customers from Oracle source to staging
       Simple pass-through with minimal transformation -->
  
  <!-- Source Qualifier -->
  <TRANSFORMATION NAME="SQ_CUSTOMERS" TYPE="SourceQualifier">
    <ATTRIBUTE NAME="Sql Query" VALUE="SELECT CUSTOMER_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, ADDRESS, CITY, STATE, ZIP_CODE, COUNTRY, CREATED_DATE, UPDATED_DATE, STATUS FROM CUSTOMERS WHERE STATUS = 'ACTIVE'"/>
  </TRANSFORMATION>
  
  <!-- Expression: Add ingestion metadata -->
  <TRANSFORMATION NAME="EXP_ADD_METADATA" TYPE="Expression">
    <TRANSFORMFIELD NAME="INGESTION_TIMESTAMP" EXPR="SYSDATE"/>
    <TRANSFORMFIELD NAME="SOURCE_SYSTEM" EXPR="'ORACLE_SRC'"/>
    <TRANSFORMFIELD NAME="BATCH_ID" EXPR="$PMMetadataFileName"/>
  </TRANSFORMATION>
  
  <!-- Target -->
  <TARGET NAME="STG_CUSTOMERS" TYPE="Target">
    <TABLE NAME="STG_CUSTOMERS" DATABASENAME="STAGING_DB"/>
  </TARGET>
  
  <!-- Connectors -->
  <CONNECTOR FROMINSTANCE="SQ_CUSTOMERS" FROMFIELD="*" TOINSTANCE="EXP_ADD_METADATA" TOFIELD="*"/>
  <CONNECTOR FROMINSTANCE="EXP_ADD_METADATA" FROMFIELD="*" TOINSTANCE="STG_CUSTOMERS" TOFIELD="*"/>
  
</MAPPING>

