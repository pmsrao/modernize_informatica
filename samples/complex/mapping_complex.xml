<?xml version="1.0"?>
<MAPPING NAME="M_LOAD_CUSTOMER">
  <TRANSFORMATION NAME="SQ_CUSTOMER" TYPE="SourceQualifier">
    <ATTRIBUTE NAME="Sql Query" VALUE="SELECT * FROM CUSTOMER_SRC"/>
  </TRANSFORMATION>

  <TRANSFORMATION NAME="EXP_DERIVE" TYPE="Expression">
    <TRANSFORMFIELD NAME="FULL_NAME" EXPR="FIRST_NAME || ' ' || LAST_NAME"/>
    <TRANSFORMFIELD NAME="AGE_BUCKET" EXPR="IIF(AGE &lt; 30, 'YOUNG', 'OTHER')"/>
  </TRANSFORMATION>

  <TRANSFORMATION NAME="LK_REGION" TYPE="Lookup">
    <LOOKUPTABLE NAME="REGION_DIM"/>
  </TRANSFORMATION>

  <TRANSFORMATION NAME="AGG_SALES" TYPE="Aggregator">
    <TRANSFORMFIELD NAME="TOTAL_SALES" EXPR="SUM(SALES_AMT)"/>
    <GROUPBYFIELD NAME="CUSTOMER_ID"/>
  </TRANSFORMATION>

  <CONNECTOR FROMINSTANCE="SQ_CUSTOMER" FROMFIELD="*" TOINSTANCE="EXP_DERIVE" TOFIELD="*"/>
  <CONNECTOR FROMINSTANCE="EXP_DERIVE" FROMFIELD="REGION_ID" TOINSTANCE="LK_REGION" TOFIELD="REGION_ID"/>
  <CONNECTOR FROMINSTANCE="LK_REGION" FROMFIELD="REGION_NAME" TOINSTANCE="AGG_SALES" TOFIELD="REGION_NAME"/>
</MAPPING>
