<?xml version="1.0"?>
<WORKLET NAME="WK_BUILD_ALL_DIMENSIONS">
  <!-- Dimension load sessions - can run in parallel -->
  <TASKINSTANCE NAME="S_M_DIM_CUSTOMER" TASKTYPE="Session"/>
  <TASKINSTANCE NAME="S_M_DIM_PRODUCT" TASKTYPE="Session"/>
  <TASKINSTANCE NAME="S_M_DIM_REGION" TASKTYPE="Session"/>
  <TASKINSTANCE NAME="S_M_DIM_CATEGORY" TASKTYPE="Session"/>
  <TASKINSTANCE NAME="S_M_DIM_SUPPLIER" TASKTYPE="Session"/>

  <!-- Nested worklet for time dimensions -->
  <TASKINSTANCE NAME="WK_TIME_DIMENSIONS" TASKTYPE="Worklet" WORKLETNAME="WK_BUILD_TIME_DIM"/>

  <!-- Hierarchical dimension processing -->
  <TASKINSTANCE NAME="S_M_DIM_HIERARCHY" TASKTYPE="Session"/>

  <!-- Dimension validation -->
  <TASKINSTANCE NAME="S_M_VALIDATE_DIMENSIONS" TASKTYPE="Session"/>

  <!-- Parallel execution of base dimensions -->
  <CONNECTOR FROMINSTANCE="S_M_DIM_CUSTOMER" FROMLINK="Success" TOINSTANCE="S_M_DIM_HIERARCHY" TOLINK="Start"/>
  <CONNECTOR FROMINSTANCE="S_M_DIM_PRODUCT" FROMLINK="Success" TOINSTANCE="S_M_DIM_HIERARCHY" TOLINK="Start"/>
  <CONNECTOR FROMINSTANCE="S_M_DIM_REGION" FROMLINK="Success" TOINSTANCE="S_M_DIM_HIERARCHY" TOLINK="Start"/>
  <CONNECTOR FROMINSTANCE="S_M_DIM_CATEGORY" FROMLINK="Success" TOINSTANCE="S_M_DIM_HIERARCHY" TOLINK="Start"/>
  <CONNECTOR FROMINSTANCE="S_M_DIM_SUPPLIER" FROMLINK="Success" TOINSTANCE="S_M_DIM_HIERARCHY" TOLINK="Start"/>
  <CONNECTOR FROMINSTANCE="WK_TIME_DIMENSIONS" FROMLINK="Success" TOINSTANCE="S_M_DIM_HIERARCHY" TOLINK="Start"/>

  <!-- Validation after hierarchy build -->
  <CONNECTOR FROMINSTANCE="S_M_DIM_HIERARCHY" FROMLINK="Success" TOINSTANCE="S_M_VALIDATE_DIMENSIONS" TOLINK="Start"/>
</WORKLET>
